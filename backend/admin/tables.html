<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>DB Tables - Admin Debug</title>
  <style>body{font-family:Arial,Helvetica,sans-serif;padding:20px}table{border-collapse:collapse;width:100%}th,td{border:1px solid #ddd;padding:8px}th{background:#f4f4f4}</style>
</head>
<body>
  <h1>Database Tables (Debug)</h1>
  <div id="info"></div>
  <table id="tbl"><thead><tr><th>Table Name</th><th>Rows (estimate)</th><th>Engine</th><th>Type</th></tr></thead><tbody></tbody></table>
  <script>
    async function fetchTables(){
      const token = localStorage.getItem('admin_token');
      const headers = token? { 'Authorization': 'Bearer '+token } : {};
      try{
        const res = await fetch('/api/admin/tables', { headers });
        if(res.status===401){ document.getElementById('info').innerText='Unauthorized - 请以管理员身份登录'; return; }
        const data = await res.json();
        if(!data.success){ document.getElementById('info').innerText='Error: '+(data.message||JSON.stringify(data)); return; }
        document.getElementById('info').innerText = 'Database: ' + (data.database || 'unknown');
        const tbody = document.querySelector('#tbl tbody'); tbody.innerHTML='';
        for(const r of data.data){
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${r.TABLE_NAME}</td><td>${r.TABLE_ROWS}</td><td>${r.ENGINE||''}</td><td>${r.TABLE_TYPE||''}</td>`;
          tbody.appendChild(tr);
        }
      }catch(e){ document.getElementById('info').innerText='Fetch error: '+e.message; }
    }
    fetchTables();
  </script>
</body>
</html>