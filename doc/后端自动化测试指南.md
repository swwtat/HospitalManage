# 后端测试说明

快速开始：

1. 进入 `backend` 目录并安装依赖：

```powershell
cd backend
npm install
```

2. 初始化数据库（可选）：项目提供 `scripts/ensure_db.js` 来创建所需表，测试运行时可以使用该脚本：

```powershell
npm run ensure-db
```

3. 运行测试：

```powershell
npm test
```

测试框架使用 `mocha`、断言 `chai`，HTTP 路由测试使用 `supertest`。测试文件位于 `backend/test`。测试尽量使用对外部依赖（DB、MQ）的存根（sinon）来避免对真实服务的强依赖。

如果需要在 CI 中运行，请使用 `npm run test:ci`，它会先运行 `ensure-db` （如果你的环境允许），然后执行 `npm test`。
